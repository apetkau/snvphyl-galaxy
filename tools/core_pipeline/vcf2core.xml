<tool id="vcf2core" name="VCF 2 % Core" version ="0.0.3">
  <description>Determine genomics core from Mpileup vcf files</description>
  <requirements>
    <requirement type="package" version="1.1">core-phylogenomics</requirement>
    <requirement type="package" version="5.18.1">perl</requirement>
  </requirements>

  <command interpreter="perl">
	/\$VCF2PSEUDO/vcf2core.pl --fasta "$fasta"
        --coverage-cutoff "$coverage"
        --positions "$positions"

	#for $f in $mpileup_collection.keys# --mpileup "$f=$mpileup_collection[$f]" #end for#

        > $out 
  </command>
  <inputs>
    <param name="fasta" type="data"  label="Fasta file" format="fasta"/>
    <param name="coverage" type="integer" value="15" label="minimum coverage"/>
    <param name="positions" type="data"  label="Pseudo Positions file" format="tabular"/>
    <param name="mpileup_collection" type="data_collection" label="Mpileup VCF" help="" optional="false" format="tabular" collection_type="list" />
  </inputs>
  <outputs>
    <data format="tabular" name="out" />
  </outputs>
  <stdio>
  	<exit_code range="1:" level="fatal" description="Unknown error has occured"/>
  </stdio>
  <!--<tests>
    <test>
      <param name="fasta" value="vcf2core/reference.fasta"/>
      <param name="coverage" value="4"/>
      <param name="positions" value="vcf2core/expected.positions.tsv"/>
      <param name="mpileup_collection">
        <collection type="list">
          <element name="v1" value="vcf2core/mpileup/v1.vcf.gz"/>
          <element name="v2" value="vcf2core/mpileup/v2.vcf.gz"/>
        </collection>
      </param>

      <output name="out" file="vcf2core/expected_core.csv"/>
    </test>
  </tests>-->

  <help>
What it does
============

Determine genomics core from Mpileup vcf files


Usage
=====

**Parameters**
  - Fasta reference file
  - Coverage cutoff (integer): minimum coverage for base pair to be considered
  - Masking positions file (tab separated file): positions to mask in the analysis
  - VCF file from mpileup
  
  </help>

</tool>
